#!/usr/bin/env python
"""reducer.py"""

import sys

total_count = 0
word_counts = {}

# First pass: Read all lines and collect counts
for line in sys.stdin:
    # Remove leading and trailing whitespace
    line = line.strip()

    # Parse the input from the mapper
    try:
        word, count = line.split('\t', 1)
        count = int(count)
    except ValueError:
        # Skip lines that cannot be parsed
        continue

    # Check for the special total count key
    if word == "__TOTAL__":
        total_count += count
    else:
        # Accumulate counts for each word
        if word in word_counts:
            word_counts[word] += count
        else:
            word_counts[word] = count

# Check if the total count is valid before proceeding
if total_count > 0:
    # Calculate and print the percentage for each word
    for word, count in word_counts.items():
        percentage = (count / total_count) * 100
        print(f'{word}\t{percentage:.2f}%')
else:
    # Print a single error message if the total count is zero or not found
    sys.stderr.write("Error: Total count is zero or not found.\n")
